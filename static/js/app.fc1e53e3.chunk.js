(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{260:function(e,t,n){e.exports=n.p+"static/media/eota-qr-code-logo.30f65d4e.png"},316:function(e,t,n){"use strict";var a=n(6),r=n.n(a),o=n(24),l=n.n(o),c=n(12),i=n.n(c),s=n(0),u=n.n(s),f=n(17),m=n(3),d=n(19),p=n(587),y=n(209),g=n(115),b=n(18),h={home:"/home",login:"/login",payInStore:"/send-money",startTransaction:"/start-transaction",balance:"/balance"},E=n(308),x=n.n(E),O=n(5),j=n.n(O),C=n(13),v=n.n(C),S=n(68),w=n(244),P=n(51);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B={placeholderTextColor:"#c4c3cb",buttonDarkText:"#45454e",facebookBlue:"#3b5998",prettyBlue:"#3897f1",googleBlue:"#4285f4",googleRed:"#ea4335",googleYellow:"#fbbc05",googleGreen:"#34a853"},z={borderRadius:6,height:45,marginBottom:8,marginHorizontal:15,backgroundColor:"rgba(0,0,0,0)"},I=T({},z,{borderColor:B.buttonDarkText,borderWidth:.7}),D={color:B.buttonDarkText},R={fontSize:18,fontWeight:"normal",textAlign:"center",color:B.buttonDarkText,marginBottom:12,marginHorizontal:15},M={container:{flex:1,justifyContent:"center",alignSelf:"stretch",alignContent:"stretch",alignItems:"stretch",paddingTop:P.a.statusBarHeight,padding:8,backgroundColor:"#fff",maxWidth:660,maxHeight:1280},paragraph:R,loadingScreenText:T({},R,{color:"#666"}),logoText:{fontFamily:"montserrat-extra-light",fontSize:60,margin:20,marginTop:10,paddingTop:20,textAlign:"center"},loginFormTextInput:{height:43,fontSize:14,borderRadius:5,borderWidth:1,borderColor:"#eaeaea",paddingHorizontal:10,marginHorizontal:15,marginBottom:8},eotaTextInput:{fontSize:14},eotaButton:I,emailLoginButton:T({},I,{marginBottom:18}),eotaButtonTitle:D,fbLoginButton:T({},z),googleLoginButton:T({},z),appleLoginButton:T({},z,{marginHorizontal:15}),transparentButton:T({},z,{backgroundColor:"#eeeeee"}),commitButton:T({},z,{backgroundColor:"#3897f1"})},A=(n(205),n(14)),L=n(123),F=n(149),H=n(56);var W=u.a.createContext({styles:M,colors:B}),U=A.a.select({android:L.a.alert,ios:L.a.alert,web:function(e,t){return alert(e+(t?" -- "+t:""))},default:function(e,t){return console.log("tried to alert to the screen on unsupported platform")}}),G=function(e,t){console.log("sending alert to screen, message: ["+e+"], detail: ["+t+"]"),U(e,t)},N=u.a.createContext({user:null,userIdToken:null,logOut:null}),J=RegExp("https://eota.me/code/([^\\s]+)");var q=function(e){var t=e.path,n=v()(e,["path"]);return Object(s.useContext)(N).user?u.a.createElement(S.b,j()({path:t},n)):u.a.createElement(S.a,{to:{pathname:h.login,state:{referrer:t}}})};var $="ios"===A.a.OS||"android"===A.a.OS,V=function(){$&&F.a.dismiss()},K=function(e){return u.a.createElement(H.a,{onPress:V},e.children)},_=function(e){var t=Object(s.useContext)(W).styles,n=Object(s.useState)(!1),a=l()(n,2),r=a[0],o=a[1];return x()((function(){return o(!0)}),e.delayMs),r&&u.a.createElement(m.a,{style:t.container},e.children)},Q=n(315),X=function(e){return u.a.createElement(m.a,{style:{margin:30}},u.a.createElement(Q.a,j()({style:{margin:20},color:"rgba(56,151,241,0.4)"},e)))},Y=function(e){var t=e.to,n=v()(e,["to"]);return u.a.createElement(S.e.Consumer,null,(function(e){return u.a.createElement(d.a,j()({onPress:function(){return e.history.push(t)}},n))}))},Z=function(){var e=Object(s.useContext)(N),t=Object(s.useContext)(W).styles,n=Object(s.useState)(!1),a=l()(n,2),r=a[0],o=a[1];return r?(e.logOut(),u.a.createElement(_,{delayMs:100},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(b.a,{style:t.paragraph},"Logging out...")))):u.a.createElement(m.a,{style:t.container},u.a.createElement(m.a,{style:{flex:4,marginBottom:20,justifyContent:"flex-end"}},u.a.createElement(d.b,{type:"feather",name:"feather",size:45}),u.a.createElement(b.a,{style:t.logoText},"eota")),u.a.createElement(m.a,{style:{flex:5,justifyContent:"flex-start"}},u.a.createElement(Y,{to:h.payInStore,title:"Scan a pay code",icon:{type:"material-community",name:"qrcode-scan"},iconContainerStyle:{marginHorizontal:10}}),u.a.createElement(Y,{to:h.startTransaction,title:"Start a transaction",icon:{type:"feather",name:"edit"},iconContainerStyle:{marginHorizontal:10}}),u.a.createElement(Y,{to:h.balance,title:"Balance",icon:{type:"feather",name:"dollar-sign"},iconContainerStyle:{marginHorizontal:5}}),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(d.a,{title:"Log out",onPress:function(){return o(!0)},icon:{type:"feather",name:"arrow-left",size:20},iconContainerStyle:{marginHorizontal:10}}))))},ee=n(91),te=n(92),ne=n(47),ae=(n(537),n(319)),re=n(318),oe={apiKey:"AIzaSyDPCvFPHMLnMmlnMTTloqHOvL35AqHXars",authDomain:"eota-gcp.web.app",projectId:"eota-gcp"},le="680742159141-natfrmficvrofb9vfhvac1mc1l0it6v4.apps.googleusercontent.com",ce="680742159141-jkb8vp076d4kjq24ia7icvmgs3b73s4s.apps.googleusercontent.com",ie="798034560635136",se=function(){return ne.auth().setPersistence(ne.auth.Auth.Persistence.LOCAL)},ue=function(e,t){return se().then((function(){return ne.auth().createUserWithEmailAndPassword(e,t)}))},fe=function(e,t){return se().then((function(){return ne.auth().signInWithEmailAndPassword(e,t)}))};function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe=function(e){G("We're sorry, something went wrong.",""+e.message),console.log("panicking: error code ["+e.code+"], message ["+e.message+"]")},ye=A.a.select({android:!0,ios:!0,default:!1}),ge=A.a.select({android:!0,ios:!0,default:!1}),be=function(e){return e&&e.trim()?(e=e.trim(),!!/(^.+@.+\..+$)/.test(e)||(G("Invalid email format",'Email should look like "you@example.com".'),!1)):(G("No email provided","Enter your email above."),!1)},he=function(e){return e?/[^\s]*\s[^\s]*/.test(e)?(G("Password must not contain spaces."),!1):!(e.length<6)||(G("Password must be 6 or more characters (no spaces)."),!1):(G("No password provided","Enter your password above."),!1)},Ee=function(e){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ae.a(ie,{permissions:["email","public_profile"]}).then((function(e){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("cancel"!==e.type){a.next=2;break}return a.abrupt("return",{cancelledByUser:!0});case 2:return t=e.token,n=ne.auth.FacebookAuthProvider.credential(t),a.next=6,r.a.awrap(ne.auth().signInWithCredential(n));case 6:return a.t0=a.sent,a.abrupt("return",{cancelledByUser:!1,userCredential:a.t0});case 8:case"end":return a.stop()}}))})));case 1:case"end":return e.stop()}})).then((function(t){t.cancelledByUser&&e(),console.log("logged in with facebook:",JSON.stringify(t.userCredential))}))},xe=function(e){return re.a({androidClientId:le,androidStandaloneAppClientId:le,iosClientId:ce,iosStandaloneAppClientId:ce,clientId:"no default client id",scopes:["profile","email"]}).then((function(e){if("cancel"===e.type)return Promise.resolve({cancelledByUser:!0,userCredential:null});var t=e.idToken,n=e.accessToken,a=ne.auth.GoogleAuthProvider.credential(t,n);return ne.auth().signInWithCredential(a).then((function(e){return{cancelledByUser:!1,userCredential:e}}))})).then((function(e){var t=e.cancelledByUser,n=e.userCredential;t||console.log("logged in with google:",JSON.stringify(n))})).catch((function(t){console.log("inexplicable google signin error:",JSON.stringify(t)),e()}))},Oe=function(e){return console.log("logged in with email:",JSON.stringify(e))};function je(e){var t=Object(s.useContext)(W),n=t.styles,a=t.colors,r=Object(s.useContext)(N),o=Object(s.useState)(!!r.user),c=l()(o,2),i=c[0],f=c[1];Object(s.useEffect)((function(){f(!!r.user)}),[r.user]);var p=e.location.state&&e.location.state.referrer||h.home,y=Object(s.useState)(""),g=l()(y,2),b=g[0],E=g[1],x=Object(s.useState)(""),O=l()(x,2),j=O[0],C=O[1],v=Object(s.useState)(!1),w=l()(v,2),P=w[0],k=w[1],T=Object(s.useState)(!1),B=l()(T,2),z=B[0],I=B[1],D=function(){return I(!1)},R=Object(s.useRef)(null),M=Object(s.useRef)(null),A=function(e){return I(!0),e().catch((function(e){D(),pe(e)}))},L=function(){var e=b,t=j;if(be(e)&&he(t)){C(null);var n=P?function(){return ue(e,t)}:function(){return fe(e,t)};A((function(){return n().then(Oe)}))}},F=u.a.createElement(ve,{ref:R,onChangeText:E,onSubmitEditing:function(){return M.current.focus()}}),H=u.a.createElement(we,{ref:M,onChangeText:C,onSubmitEditing:L}),U=u.a.createElement(m.a,null,F,H,u.a.createElement(d.a,{title:"Login",titleStyle:n.eotaButtonTitle,onPress:L,buttonStyle:n.eotaButton,style:{marginBottom:5}}),ge&&u.a.createElement(d.a,{title:"Continue with Facebook",onPress:function(){return A((function(){return Ee(D)}))},buttonStyle:de({},n.fbLoginButton),titleStyle:{color:a.prettyBlue},icon:{type:"feather",name:"facebook",color:a.prettyBlue},iconContainerStyle:{marginHorizontal:10},style:{borderWidth:0}}),ye&&u.a.createElement(d.a,{title:"Continue with Google",onPress:function(){return A((function(){return xe(D)}))},buttonStyle:n.googleLoginButton,titleStyle:{color:a.googleRed},icon:{type:"font-awesome",name:"google",color:a.googleRed},iconContainerStyle:{marginHorizontal:11},style:{borderWidth:0}})),G=u.a.createElement(m.a,null,F,H,u.a.createElement(d.a,{title:"Sign up",titleStyle:{color:a.buttonDarkText},onPress:L,buttonStyle:n.emailLoginButton,icon:{type:"feather",name:"arrow-right",color:a.buttonDarkText},iconRight:!0,iconContainerStyle:{marginHorizontal:10}}));return i?u.a.createElement(S.a,{push:!0,to:p}):z?u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:n.paragraph},"logging you in..."))):u.a.createElement(K,null,u.a.createElement(te.a,{behavior:"padding",style:n.container},u.a.createElement(m.a,{style:{flex:1,flexDirection:"column"}},u.a.createElement(m.a,{style:{flex:5,margin:10,marginTop:35,justifyContent:"flex-end"}},u.a.createElement(d.b,{type:"feather",name:"feather",size:45}),u.a.createElement(d.d,{style:n.logoText},"eota")),u.a.createElement(m.a,{style:{flex:8}},P?G:U),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},P?u.a.createElement(d.a,{title:"Log in instead",titleStyle:{color:a.prettyBlue},onPress:function(){return k(!1)},buttonStyle:n.transparentButton}):u.a.createElement(d.a,{title:"Sign up",titleStyle:{color:a.prettyBlue},onPress:function(){return k(!0)},buttonStyle:n.transparentButton})))))}var Ce=A.a.select({ios:{textContentType:"emailAddress"},android:{autoCompleteType:"email"},default:null}),ve=u.a.forwardRef((function(e,t){var n=e.onChangeText,a=e.onSubmitEditing,r=Object(s.useContext)(W).styles;return u.a.createElement(ee.a,j()({placeholder:"email",style:r.loginFormTextInput,keyboardType:"email-address",clearButtonMode:"while-editing",autoCapitalize:"none",returnKeyType:"next",ref:t,onChangeText:n,onSubmitEditing:a},Ce))})),Se=A.a.select({ios:{textContentType:"password"},android:{autoCompleteType:"password"},default:null}),we=u.a.forwardRef((function(e,t){var n=e.onChangeText,a=e.onSubmitEditing,r=Object(s.useContext)(W).styles;return u.a.createElement(ee.a,j()({placeholder:"password",style:r.loginFormTextInput,clearButtonMode:"while-editing",autoCapitalize:"none",secureTextEntry:!0,returnKeyType:"go",ref:t,onChangeText:n,onSubmitEditing:a},Se))})),Pe=n(7),ke=n.n(Pe),Te=n(9),Be=n.n(Te),ze=n(8),Ie=n.n(ze),De=n(10),Re=n.n(De),Me=n(161),Ae=n.n(Me),Le=n(105),Fe=n(36),He=n(48),We=n(310),Ue=n(2),Ge=n(207),Ne=n(206),Je=n(44),qe=n(163),$e=n(208);function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=P.a.manifest.releaseChannel?P.a.manifest.android.package:"host.exp.exponent",Qe=A.a.select({android:function(){return $e.b($e.a,{data:"package:"+_e})},ios:function(){return Le.a.openURL("app-settings:")},default:null}),Xe=function(){return Ne.b(Ne.a).then((function(e){return e.status===Je.a.GRANTED})).catch((function(e){var t="Unexpected error getting camera permission",n="Try closing and reopening the app. \nInfo: error code ["+e.code+"], error message ["+e.message+"]";return console.error(t,n),G(t,n),!1}))};function Ye(e){var t=Object(s.useContext)(W).styles,n=Object(s.useState)(null),a=l()(n,2),r=a[0],o=a[1];Object(s.useEffect)((function(){"web"===A.a.OS?o(!1):Xe().then((function(e){return o(e)}))}));var c=function(t){var n=t.type,a=t.data;console.log("Bar code scanned: type ["+n+"], data ["+a+"]. Emitting to parent."),e.emitResult({type:n,data:a})},i=Object(s.useMemo)((function(){switch(r){case null:return u.a.createElement(_,{delayMs:200},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:t.paragraph},"Requesting permission to access camera...")));case!0:return u.a.createElement(Ge.a,{onBarCodeScanned:c,barCodeTypes:[Ge.a.Constants.BarCodeType.qr],style:Ue.a.absoluteFillObject});case!1:return u.a.createElement(m.a,{style:t.container},u.a.createElement(m.a,{style:{margin:35}},u.a.createElement(qe.a,{name:"frown",size:75,style:{textAlign:"center"}})),u.a.createElement(d.d,{style:t.paragraph},"Unable to access the camera."),Qe?u.a.createElement(d.a,{title:"Open camera settings",onPress:Qe}):u.a.createElement(d.d,{style:t.paragraph},"Enable camera access to continue."));default:throw Error("something strange happened getting camera permissions, return value ["+r+"]")}}),[r]),f=u.a.createElement(d.a,{title:"Go back",onPress:e.onCancel,buttonStyle:t.transparentButton});return!0===r?u.a.createElement(m.a,{style:Ke({},Ue.a.absoluteFillObject,{flex:1,flexDirection:"column"})},i,u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},f)):u.a.createElement(m.a,{style:t.container},u.a.createElement(m.a,{style:{flex:5,justifyContent:"center"}},i),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},f))}var Ze=n(317),et=n(31),tt=n(260),nt=function(e){var t=e.value,n=e.size;return u.a.createElement(m.a,null,u.a.createElement(et.a,{style:{borderRadius:9,borderWidth:.7,borderColor:"#333",overflow:"hidden"}},u.a.createElement(Ze.a,{value:t,size:n||250,logo:tt,logoSize:.4*(n||250),color:"#113422",backgroundColor:"#fff",logoBackgroundColor:"transparent",ecl:"Q",getRef:null})))};function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot="https://us-central1-eota-gcp.cloudfunctions.net/api",lt=function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=ct,t.t1=e,t.t2=e.status,t.next=5,r.a.awrap(e.json());case 5:return t.t3=t.sent,t.abrupt("return",new t.t0(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}))},ct=function(e){function t(e,n,a){var r;return ke()(this,t),(r=Be()(this,Ie()(t).call(this,"Bad response from eota api: "))).name="ApiError",r.status=n,r.responseJson=a,r.response=e,r}return Re()(t,e),t}(Ae()(Error)),it=function(e){console.log("API call failure:",e);var t=e&&e.responseJson||null,n=t&&t.errorMessage||"something unexpected happened";G("Error:",n)},st=function(e){return{"Content-Type":"application/json",Authorization:"Bearer "+e,Accept:"application/json"}},ut=function(e,t){var n,a,o,l;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.body,a=e.token,o=t.signal,c.next=4,r.a.awrap(fetch(ot+"/transaction",{method:"POST",body:JSON.stringify(n),headers:st(a),signal:o}));case 4:if((l=c.sent).ok){c.next=9;break}return c.next=8,r.a.awrap(lt(l));case 8:throw c.sent;case 9:return c.abrupt("return",l.json());case 10:case"end":return c.stop()}}))},ft=function(e){var t,n=e.txn,a=Object(s.useContext)(W),r=a.styles,o=a.colors,l=r.paragraph;return u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-start",alignContent:"center",marginTop:15}},u.a.createElement(d.d,{style:rt({},l,{fontWeight:"bold",marginBottom:15})},"Payment info:"),u.a.createElement(d.d,{style:rt({},l,{textAlign:"left"})},"Amount: $",n.amount,"\n","To: ",n.recipientDisplayName||n.recipientEmail,"\n","For: ",n.desc,"\n","Created: ",(t=n.timeUsecCreated,new Date(t).toLocaleString()),"\n"),u.a.createElement(d.d,{onPress:function(){return Le.a.openURL("https://eota.me")},style:rt({},l,{fontSize:16,color:o.prettyBlue,textDecorationLine:"underline"})},"Transaction ID: ",n.id,"\n"))},mt=function(){var e=Fe.a.get("window"),t=e.height,n=(e.width,550-t);return n>0?250-n:250},dt=function(e){var t=e.body,n=Object(s.useContext)(N).userIdToken,a=Object(s.useContext)(W).styles.paragraph;return u.a.createElement(He.a,{promiseFn:ut,onReject:it,body:t,token:n},u.a.createElement(He.a.Pending,null,u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:a},"setting things up...")))),u.a.createElement(He.a.Fulfilled,null,(function(e){return u.a.createElement(pt,{txn:e})})))},pt=function(e){var t=e.txn,n=Object(s.useContext)(N).userIdToken,a=Object(s.useContext)(W),r=a.styles,o=a.colors,c=r.paragraph,i=Object(He.b)(ot+"/transaction/"+t.id,{method:"GET",headers:st(n)}),f=i.data,p=i.setData,y=i.error,g=i.run,b=i.reload,h=Object(s.useState)(2500),E=l()(h,2),x=E[0],O=E[1];return g(),Object(We.a)((function(){f?f.timeUsecPaid?O(null):(p(null),b()):y&&(console.warn("error on fetch",y),p(null),b())}),x),f&&f.timeUsecPaid?u.a.createElement(m.a,null,u.a.createElement(d.b,{type:"feather",name:"check-circle",size:50,color:o.prettyBlue,style:{fontWeight:"300"}}),u.a.createElement(d.d,{style:rt({},c,{margin:20})},"$"+f.amount+" paid in full.")):u.a.createElement(m.a,{style:rt({},r.container,{justifyContent:"flex-start"})},u.a.createElement(m.a,{style:{flex:4,marginBottom:12,justifyContent:"flex-end"}},u.a.createElement(ft,{txn:t})),u.a.createElement(m.a,{style:{flex:5,justifyContent:"flex-start",alignItems:"center",margin:12}},u.a.createElement(nt,{value:"https://eota.me/code/"+t.id,size:mt()})))},yt=function(){var e=Object(s.useContext)(W).styles,t=Object(s.useState)(""),n=l()(t,2),a=n[0],r=n[1],o=Object(s.useState)(""),c=l()(o,2),i=c[0],f=c[1],p=Object(s.useState)(!1),y=l()(p,2),g=y[0],b=y[1];return g?u.a.createElement(m.a,{style:rt({},e.container)},u.a.createElement(m.a,{style:{flex:6,justifyContent:"center"}},u.a.createElement(dt,{body:{currency_code:"usd",amount:a,desc:i}})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(Y,{to:h.home,title:"Go back",buttonStyle:e.transparentButton}))):u.a.createElement(K,null,u.a.createElement(te.a,{behavior:"padding",style:{flex:1,justifyContent:"center"}},u.a.createElement(m.a,{style:{flex:7,justifyContent:"center"}},u.a.createElement(bt,{onChangeText:r}),u.a.createElement(ht,{onChangeText:f})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(d.a,{onPress:function(){if(a)if(/[1-9]/.test(a)){var e=gt(a);e?G(e):b(!0)}else G("Must be at least $0.01");else G("Must provide a dollar amount")},title:"Get Code",buttonStyle:e.commitButton,titleStyle:{color:"#fff"},icon:{type:"material-community",name:"qrcode-scan",color:"#fff",size:21},iconRight:!0,iconContainerStyle:{marginHorizontal:12,paddingTop:1}}),u.a.createElement(Y,{to:h.home,title:"Cancel",buttonStyle:e.transparentButton}))))},gt=function(e){if(!RegExp("^[0-9\\.]*$").exec(e))return"Only 0-9 and . allowed";var t=e.split(".");return t.length>2?"Only one . allowed":t[1]&&t[1].length>2?"No more than 2 decimal places (e.g. 100.00)":null},bt=function(e){var t=e.onChangeText,n=Object(s.useState)(""),a=l()(n,2),r=a[0],o=a[1];return u.a.createElement(d.c,{keyboardType:"numeric",placeholder:"0.00",leftIcon:{type:"feather",name:"dollar-sign"},leftIconContainerStyle:{marginLeft:0,marginRight:8},errorStyle:{color:"red"},errorMessage:r,clearButtonMode:"always",onChangeText:function(e){o(gt(e)),t(e)},style:{color:"#222"},inputStyle:{fontFamily:"montserrat-medium",color:"#222",fontSize:24},containerStyle:{marginBottom:30}})},ht=function(e){var t=e.onChangeText,n=Object(s.useContext)(W).styles,a=Object(s.useState)(null),r=l()(a,2),o=r[0],c=r[1],i=Object(s.useState)(null),f=l()(i,2),m=f[0],p=f[1];return u.a.createElement(d.c,{keyboardType:"default",placeholder:"What\u2019s it for?",maxLength:2e3,leftIcon:{type:"feather",name:"edit-2",size:22},leftIconContainerStyle:{marginLeft:4,marginRight:8},errorMessage:o,errorStyle:{color:m},clearButtonMode:"always",onChangeText:function(e){var n=function(e){var t=1e3-e.length;return t<=100?{message:e.length+"/1000",color:t<=0?"red":"#ebc600"}:{}}(e),a=n.message,r=n.color;c(a),p(r),t(e)},style:n.eotaTextInput})},Et=function(){var e=Object(s.useContext)(W).styles,t=Object(s.useState)(null),n=l()(t,2),a=n[0],r=n[1],o=Object(s.useState)(!1),c=l()(o,2),i=c[0],f=c[1],d=Object(s.useState)(!1),p=l()(d,2),y=p[0],g=p[1];return i?u.a.createElement(S.a,{push:!0,to:h.home}):a?u.a.createElement(m.a,{style:{flex:1,justifyContent:"center"}},u.a.createElement(m.a,{style:{flex:10,justifyContent:"center"}},y?u.a.createElement(Ct,{invoiceId:a}):u.a.createElement(Ot,{invoiceId:a,onSendPayment:function(){return g(!0)}})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(Y,{to:h.home,title:"Go back",buttonStyle:e.transparentButton}))):u.a.createElement(Ye,{emitResult:function(e){var t=function(e){var t=J.exec(e),n=!!t;return[n,n?{paycode:t[1],matchedUrl:t[0]}:null]}(e.data),n=l()(t,2),a=n[0],o=n[1];a&&r(o.paycode)},onCancel:function(){return f(!0)}})},xt=function(e,t){var n,a,o,l;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.params,a=e.token,o=t.signal,c.next=4,r.a.awrap(fetch(ot+"/transaction/"+n.invoiceId,{method:"GET",headers:st(a),signal:o}));case 4:if((l=c.sent).ok){c.next=9;break}return c.next=8,r.a.awrap(lt(l));case 8:throw c.sent;case 9:return c.abrupt("return",l.json());case 10:case"end":return c.stop()}}))},Ot=function(e){var t=e.invoiceId,n=e.onSendPayment,a=Object(s.useContext)(N).userIdToken,r=Object(s.useContext)(W).styles,o=r.paragraph;return u.a.createElement(He.a,{promiseFn:xt,onReject:it,params:{invoiceId:t},token:a},u.a.createElement(He.a.Pending,null,u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:o},"setting things up...")))),u.a.createElement(He.a.Fulfilled,null,(function(e){return u.a.createElement(m.a,{style:rt({},r.container,{justifyContent:"flex-end"})},u.a.createElement(m.a,{style:{flex:1}}),u.a.createElement(m.a,{style:{flex:1,marginBottom:12,justifyContent:"flex-end"}},u.a.createElement(ft,{txn:e})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-start"}},u.a.createElement(d.a,{onPress:n,title:"Pay",buttonStyle:r.commitButton,titleStyle:{color:"#fff"},icon:{type:"font-awesome",name:"credit-card",color:"#fff",size:21},iconRight:!0,iconContainerStyle:{marginHorizontal:12,paddingTop:1}})))})),u.a.createElement(He.a.Rejected,null,u.a.createElement(d.d,null,"fdadfasgasdhhhhhh")))},jt=function(e,t){var n,a,o,l;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.params,a=e.token,o=t.signal,c.next=4,r.a.awrap(fetch(ot+"/transaction/"+n.invoiceId+"/pay",{method:"PUT",headers:st(a),signal:o}));case 4:if((l=c.sent).ok){c.next=9;break}return c.next=8,r.a.awrap(lt(l));case 8:throw c.sent;case 9:return c.abrupt("return",l.json());case 10:case"end":return c.stop()}}))},Ct=function(e){var t=e.invoiceId,n=Object(s.useContext)(N).userIdToken,a=Object(s.useContext)(W),r=a.styles,o=a.colors,l=r.paragraph;return u.a.createElement(He.a,{promiseFn:jt,onReject:it,params:{invoiceId:t},token:n},u.a.createElement(He.a.Pending,null,u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:l},"sending payment...")))),u.a.createElement(He.a.Fulfilled,null,(function(e){return u.a.createElement(m.a,null,u.a.createElement(d.b,{type:"feather",name:"check-circle",size:50,color:o.prettyBlue,style:{fontWeight:"300"}}),u.a.createElement(d.d,{style:rt({},l,{margin:20})},"Paid $"+e.amount+" in full."))})))},vt=function(e,t){var n,a,o,l;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.uid,a=e.token,o=t.signal,c.next=4,r.a.awrap(fetch(ot+"/user/"+n,{method:"GET",headers:st(a),signal:o}));case 4:if((l=c.sent).ok){c.next=9;break}return c.next=8,r.a.awrap(lt(l));case 8:throw c.sent;case 9:return c.abrupt("return",l.json());case 10:case"end":return c.stop()}}))},St=function(){var e=Object(s.useContext)(N),t=e.user,n=e.userIdToken,a=Object(s.useContext)(W).styles,r=a.paragraph,o=Object(s.useState)(!1),c=l()(o,2),i=c[0],f=c[1];return u.a.createElement(He.a,{promiseFn:vt,onReject:it,uid:t.uid,token:n},u.a.createElement(He.a.Pending,null,u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:r},"opening your account...")))),u.a.createElement(He.a.Fulfilled,null,(function(e){return u.a.createElement(te.a,{behavior:"padding",style:rt({},a.container,{justifyContent:"center"})},u.a.createElement(m.a,{style:{flex:10,justifyContent:"center"}},i?u.a.createElement(wt,{onCancel:function(){return f(!1)}}):u.a.createElement(Pt,{user:e,onAddMoney:function(){return f(!0)}})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(Y,{to:h.home,title:"Go back",buttonStyle:a.transparentButton})))})))},wt=function(e){var t=e.onCancel,n=Object(s.useContext)(N),a=n.user,o=n.userIdToken,c=Object(s.useContext)(W),i=c.styles,f=c.colors,p=i.paragraph,y=Object(s.useState)(""),g=l()(y,2),b=g[0],h=g[1],E=Object(He.b)(ot+"/user/"+a.uid+"/balance",{method:"POST",headers:st(o)}),x=E.data,O=E.setData,j=E.error,C=E.isPending,v=E.run,S=Object(s.useState)(null),w=l()(S,2),P=w[0];w[1];if(j)it(j),O(null);else{if(C)return u.a.createElement(_,{delayMs:150},u.a.createElement(m.a,null,u.a.createElement(X,null),u.a.createElement(d.d,{style:p},"transferring money to your account...")));if(x&&P){var k=x;return u.a.createElement(m.a,null,u.a.createElement(d.b,{type:"feather",name:"check-circle",size:50,color:f.prettyBlue,style:{fontWeight:"300"}}),u.a.createElement(d.d,{style:rt({},p,{margin:20})},"Total balance now $"+k.balanceUSD+"."))}}return u.a.createElement(m.a,{style:rt({},i.container,{flex:10,justifyContent:"center"})},u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(bt,{onChangeText:h})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-start"}},u.a.createElement(d.a,{onPress:function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=b){n.next=4;break}return G("Must provide a dollar amount"),n.abrupt("return");case 4:if(/[1-9]/.test(e)){n.next=7;break}return G("Must be at least $0.01"),n.abrupt("return");case 7:if(!(t=gt(e))){n.next=11;break}return G(t),n.abrupt("return");case 11:v({body:JSON.stringify({addition:e})});case 12:case"end":return n.stop()}}))},title:"Submit",buttonStyle:i.commitButton,titleStyle:{color:"#fff"},icon:{type:"feather",name:"credit-card",color:"#fff",size:21},iconRight:!0,iconContainerStyle:{marginLeft:12,paddingTop:1}}),u.a.createElement(d.a,{title:"Cancel",onPress:t,style:{margin:10},icon:{type:"feather",name:"corner-left-down",size:21},iconContainerStyle:{marginRight:12}})))},Pt=function(e){var t=e.user,n=e.onAddMoney,a=Object(s.useContext)(W).styles,r=a.paragraph;return u.a.createElement(m.a,{style:rt({},a.container,{flex:10})},u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-end"}},u.a.createElement(d.d,{style:rt({},r,{color:"#222",fontFamily:"montserrat-medium",fontSize:26,paddingBottom:8})},"Balance:"),u.a.createElement(d.a,{title:t.balanceUSD,disabled:!0,disabledStyle:{backgroundColor:"#fff"},disabledTitleStyle:{fontSize:32,paddingVertical:18,paddingHorizontal:5,fontFamily:"montserrat-medium",color:"#222"},icon:{type:"feather",name:"dollar-sign"},iconContainerStyle:{marginHorizontal:.5,justifyContent:"center",alignContent:"center",alignItems:"center"}})),u.a.createElement(m.a,{style:{flex:1,justifyContent:"flex-start"}},u.a.createElement(d.a,{onPress:n,title:"Add Money",style:{margin:20},icon:{type:"feather",name:"corner-right-up",size:21},iconRight:!0,iconContainerStyle:{marginHorizontal:12},buttonStyle:rt({},a.eotaButton,{borderWidth:0})})))};function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"a",(function(){return At}));var Bt={Button:{buttonStyle:Tt({},z),titleStyle:{color:B.buttonDarkText}},colors:{primary:"#fff",secondary:"#999"}};!function(){if(!ne.apps.length)ne.initializeApp(oe)}();var zt=function(){return ne.auth().signOut().catch((function(e){return G("Error logging out: error code ["+e.code+"], message ["+e.message+"]")}))},It=function(){var e,t=Object(s.useState)(ne.auth().currentUser),n=l()(t,2),a=n[0],o=n[1],c=Object(s.useState)(null),i=l()(c,2),f=i[0],p=i[1];return e=function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(o(e),e){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.t0=p,t.next=7,r.a.awrap(e.getIdToken(!0));case 7:t.t1=t.sent,(0,t.t0)(t.t1),t.next=14;break;case 11:t.prev=11,t.t2=t.catch(3),console.log("could not update user token. error code: ["+t.t2.code+"], message: ["+t.t2.message+"], user: ["+JSON.stringify(e)+"]");case 14:case"end":return t.stop()}}),null,null,[[3,11]])},ne.auth().onAuthStateChanged(e),u.a.createElement(N.Provider,{value:{user:a,userIdToken:f,logOut:zt}},u.a.createElement(W.Provider,{value:{styles:M,colors:B}},u.a.createElement(d.e,{theme:Bt},u.a.createElement(m.a,{style:{flexDirection:"row",flex:1,justifyContent:"center"}},u.a.createElement(Dt,null,u.a.createElement(w.a,null,u.a.createElement(S.a,{to:h.home}),u.a.createElement(S.d,null,u.a.createElement(S.b,{path:h.login,component:je}),u.a.createElement(q,{path:h.home,component:Z}),u.a.createElement(q,{path:h.payInStore,component:Et}),u.a.createElement(q,{path:h.startTransaction,component:yt}),u.a.createElement(q,{path:h.balance,component:St}))))))))},Dt=function(e){var t=Object(s.useState)(new f.a.Value(0)),n=l()(t,1)[0];return u.a.useEffect((function(){f.a.timing(n,{toValue:1,duration:600}).start()}),[]),u.a.createElement(f.a.View,{style:Tt({},M.container,{opacity:n})},e.children)},Rt=[n(260),n(571),n(572)];function Mt(e){var t=Object(s.useState)(!1),a=l()(t,2),o=a[0],c=a[1];return o?u.a.createElement(e.component,null):u.a.createElement(p.a,{startAsync:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(Promise.all(Rt.map((function(e){return y.a.fromModule(e).downloadAsync()}))));case 2:return e.next=4,r.a.awrap(g.b({"montserrat-extra-light":n(573),"montserrat-medium":n(574)}));case 4:case"end":return e.stop()}}))},onFinish:function(){return c(!0)},onError:console.warn})}function At(){return u.a.createElement(Mt,{component:It})}},379:function(e,t,n){n(380),e.exports=n(579)},380:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/expo-service-worker.js",{scope:"/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},571:function(e,t,n){e.exports=n.p+"static/media/eota-qr-code-logo-full-splash.8e4a826e.png"},572:function(e,t,n){e.exports=n.p+"static/media/feather-1024-white-background.bae604b5.png"},573:function(e,t,n){e.exports=n.p+"./fonts/Montserrat-ExtraLight.ttf"},574:function(e,t,n){e.exports=n.p+"./fonts/Montserrat-Medium.ttf"}},[[379,1,2]]]);
//# sourceMappingURL=../../28b60b51b1a7f2cbee45.map